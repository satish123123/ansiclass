---
-

 hosts: all
 # gather_facts: true # this will make not to gather facts before running tasks

 vars_files:
    service.yml
  
 tasks: 
  #  - name: bits service
    #  win_service: 
    - name: "{{item}}"
 #     debug:
 #      msg: >
              {% if item == "BITS" -%}
                  win_service: 
                  name: item
                  state: stopped
              {% elif item == "Dnscache" -%}
                  win_service: 
                  name: item
                  state: stopped
              {% else -%}
                   This is not found
              {% endif %}
      loop:
          "{{serviceneedstostop}}"
             

...