---
-

 hosts: all
 # gather_facts: true # this will make not to gather facts before running tasks

 vars_files:
    service.yml
  
 tasks: 
    - name: bits service 
      win_service: 
        name: "{{item}}"
      
          debug:
        msg: >
            This is test if ansible
             {% for services in win_service -%}
                  {% if win_service == "BITS" -%}
                   state: started

                  {% elif win_service == "Dnscache" -%}
                    state: stopped
                    This is DNScache
                  {% else -%}
                   This is not found
                  {% endif %}
             {% endfor -%}
        loop:
          "{{serviceneedstostop}}"
             

...